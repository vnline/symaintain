{% extends "systack/base.html" %}{% block title %}游戏热更{% endblock %}{% block mainbar %}    <div class="mainbar">        <div class="page-head">            <h2 class="pull-left"><i class="icon-table"></i>游戏热更</h2>            <!-- Breadcrumb -->            <div class="bread-crumb pull-right">                <a href="/"><i class="icon-home"></i> Home</a>                <span class="divider">/</span>                <a href="/hotupdate" class="bread-current">Hot_Update</a>            </div>            <div class="clearfix"></div>        </div>        <div class="matter">            <div class="container">                <!-- Table -->                <div class="row">                    <div class="col-md-12">                        <div class="widget">                            <div class="widget-head">                                <div class="pull-left">Tables</div>                                <div class="widget-icons pull-right">                                    <a href="#" class="wminimize"><i class="icon-chevron-up"></i></a>                                    <a href="#" class="wclose"><i class="icon-remove"></i></a>                                </div>                                <div class="clearfix"></div>                            </div>                            <div class="widget-content">                            <div class="table-responsive">                                <table class="table table-striped table-bordered table-hover">                                    <thead>                                    <tr>                                        <th>#</th>                                        <th>目标</th>                                        <th>文件</th>                                        <th>更新时间</th>                                        <th>操作者</th>                                        <th>日志</th>                                    </tr>                                    </thead>                                    <tbody>                                    {% if hot %}                                        {% for list_items in hot.object_list %}                                            <tr>                                                <td>{{ list_items.id }}</td>                                                <td>{{ list_items.target }}</td>                                                <td>{{ list_items.files }}</td>                                                <td>{{ list_items.mtime|date:"Y-m-d H:i:s" }}</td>                                                <td>{{ list_items.deployed_by }}</td>                                                <td class="jids" style="display: none">{{ list_items.jids }}</td>                                                <td>                                                    <a class="btn btn-info hotlog" data-toggle="modal"> 查看日志</a>                                                </td>                                            </tr>                                        {% endfor %}                                    {% endif %}                                    </tbody>                                </table>                                <div class="widget-foot">                                    <ul class="pagination pull-right">                                        {% if hot.has_previous  %}                                            <li><a href="?page={{ hot.previous_page_number }}">Prev</a></li>                                        {% endif %}                                        <li><a href="?page={{ hot.number }}">{{ hot.number }}</a></li>                                        {% if hot.has_next %}                                            <li><a href="?page={{ hot.next_page_number }}">Next</a></li>                                        {% endif %}                                    </ul>                                </div>                            </div>                            <div class="clearfix"></div>                            <div class="widget-head">                                <div class="pull-left">热更新</div>                                <div class="clearfix"></div>                            </div>                            <div class="padd">                                <div class="form quick-post">                                    <!-- Quick setting form (not working)-->                                    <form id="hot" class="form-horizontal" action="hotupdate" method="post">{% csrf_token %}                                        <!-- Name -->                                        <div class="form-group">                                            <label class="control-label col-lg-3" for="target">目标</label>                                            <div class="col-sm-5">                                                <input type="text" class="form-control" id="target" placeholder="目标" name="target">                                            </div>                                        </div>                                        <div class="form-group">                                            <label class="control-label col-lg-3" for="files">文件</label>                                            <div class="col-sm-5">                                                <textarea class="form-control" id="files" placeholder="请填写要热更新的文件" name="files"></textarea>                                            </div>                                        </div>                                        <!-- Buttons -->                                        <div class="form-actions">                                            <!-- Buttons -->                                            <button id=submit type="submit" class="btn btn-info">提交</button>                                            <button type="reset" class="btn btn-default">重置</button>                                        </div>                                    </form>                                </div>                            </div>                        </div>                    </div>                </div>            </div>        </div>    </div>    </div>    <!-- deliver modal event -->    <div id="hotlog" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">        <div class="modal-dialog">            <div class="modal-content">                <div class="modal-header">                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>                    <h3 id="myModalLabel">日志</h3>                </div>                <div>                    <div id="modal-body" class="modal-body">                        <p>暂没有日志哦！</p>                    </div>                </div>                <div class="modal-footer">                    <button class="btn btn-default" data-dismiss="modal" aria-hidden="true">关闭</button>                </div>            </div>        </div>    </div>{% endblock %}{% block js %}    <script type="text/javascript">        $(function(){            $(".hotlog").click(function(){                var jids =$(this).parents("tr").find('.jids').text();                $.ajax({                    type: "GET",                    url: "{% url 'systack.views.get_log' %}",                    data : {conf_jids:jids,role:'node'},                    success: function(data){                        $("#modal-body").html(data);                        $("#log").remove();                        $("th#role").remove();                        $("th#main").remove();                        $("td#role_id").remove();                        $("td#main_id").remove();                        $('#hotlog').modal()                    },                    error: function(data){                        $('#hotlog').modal()                    }                })            })        })    </script>{% endblock %}